<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Artikel</title>
</head>
<body>
  <h1 id="artikel-title">Lade Artikelâ€¦</h1>
  <div id="artikel-content">Bitte wartenâ€¦</div>
  <p><a href="/">ZurÃ¼ck zur Startseite</a></p>

  <script>
    console.log("ðŸ“Œ Script gestartet");

    // URL-Parameter auslesen
    const params = new URLSearchParams(window.location.search);
    const slug = params.get("slug");
    console.log("ðŸ”¹ Gefundener Slug:", slug);

    if (!slug) {
      console.warn("âš ï¸ Kein Slug angegeben");
      document.getElementById("artikel-title").textContent = "Kein Artikel ausgewÃ¤hlt";
      document.getElementById("artikel-content").textContent = "Bitte Ã¼ber die URL einen Artikel-Slug angeben, z.B. ?slug=fancy-artikel";
    } else {
      const url = `https://ngtujvgsbymtxphwncuj.supabase.co/storage/v1/object/public/articles/${slug}.json`;
      console.log("ðŸŒ Fetch URL:", url);

      fetch(url)
        .then(res => {
          console.log("ðŸ“¦ Response Status:", res.status, res.statusText);
          if (!res.ok) throw new Error("Artikel nicht gefunden oder Zugriff verweigert");
          return res.text(); // erst mal als Text, um mÃ¶gliche Fehler zu sehen
        })
        .then(text => {
          console.log("ðŸ“„ Geladener Text:", text);

          let data;
          try {
            data = JSON.parse(text);
            console.log("âœ… JSON erfolgreich geparst:", data);
          } catch(e) {
            console.error("âŒ JSON Parsing Fehler:", e, "Text war:", text);
            throw e;
          }

          document.getElementById("artikel-title").textContent = data.title;
          document.getElementById("artikel-content").innerHTML = data.content;
        })
        .catch(err => {
          console.error("ðŸ’¥ Fehler beim Laden des Artikels:", err);
          document.getElementById("artikel-title").textContent = "Fehler beim Laden des Artikels";
          document.getElementById("artikel-content").textContent = err.message;
        });
    }

    console.log("ðŸ“Œ Script Ende");
  </script>
</body>
</html>
